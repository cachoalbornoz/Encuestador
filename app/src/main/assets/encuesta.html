<!DOCTYPE html>
<html>
<head>
    <title>SgeerMovil</title>
    <meta charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="mi_estilo.css" rel="stylesheet" type="text/css"/>
    <link href="jquery.mobile.icons.min.css" rel="stylesheet" type="text/css"/>

    <script src="jquery.js" type="text/javascript"></script>
    <script type="text/javascript">

        $(document).bind('mobileinit',function(){
            $.mobile.changePage.defaults.changeHash = false;
            $.mobile.hashListeningEnabled = false;
            $.mobile.pushStateEnabled = false;
        });

    </script>

    <link href="jquery.mobile-1.4.5.css" rel="stylesheet" type="text/css"/>
    <script src="jquery.mobile-1.4.5.js" type="text/javascript"></script>

    <style>
        .ui-page { -webkit-backface-visibility: hidden; }
    </style>
</head>


<body>

<form id="encuesta" onreset="beforeReset()" data-exclude-selector="">
    <div data-role="page" id="pagina0">
        <div data-role="header" style="text-align: center">
            <h5>&COPY; SGE-V 1.1</h5>
            <label>Pregunta 0 de 5</label>
        </div>
        <div data-role="content">
            <div class="ui-content">
                <label for="usuario">Nro de Usuario</label>
                <select id="usuario" name="usuario" size="1" data-native-menu="false" class="exclude">
                    <option value="1" selected="selected">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                    <option value="8">8</option>
                    <option value="9">9</option>
                    <option value="10">10</option>
                    <option value="11">11</option>
                    <option value="12">12</option>
                    <option value="13">13</option>
                    <option value="14">14</option>
                    <option value="15">15</option>
                    <option value="16">16</option>
                    <option value="17">17</option>
                    <option value="18">18</option>
                    <option value="19">19</option>
                    <option value="20">20</option>
                </select>
                <input type="hidden"  name="id_encuesta" id="id_encuesta" value="24" class="exclude"/>
            </div>
        </div>
        <div data-role="footer" data-position="fixed">
            <div data-role="navbar">
                <ul>
                    <li><a href="#" onClick="salida()" data-iconpos="bottom" data-icon="power">Salir</a></li>
                    <li><a href="#ayuda" data-iconpos="bottom" data-icon="info" data-rel="dialog">Ayuda</a></li>
                    <li><a href="#pagina1" data-iconpos="bottom" data-icon="arrow-r">Iniciar</a></li>
                    <li><a href="#acerca" data-iconpos="bottom" data-icon="star"  data-rel="dialog">Acerca de</a></li>
                </ul>
            </div>
        </div>
    </div>

    <div data-role="page" id="acerca">
        <div data-role="header">
            <h1>Autor SGE-V 1.1</h1>
        </div>
        <div data-role="content" class="ui-content">
            <p>Guillermo Albornoz </p>
            <p>cachoalbornoz@gmail.com</p>
        </div>
        <div data-role="footer">
            <div style=" text-align: center">
                <a href="#" data-role="button" data-icon="phone" data-mini="true" data-iconpos="notext">Tel</a>
                343 4586951 / Paraná E.Rios
            </div>
        </div>
    </div>

    <div data-role="page" id="ayuda">
        <div data-role="header">
            <h6>Configuraciones</h6>
        </div>
        <div data-role="content" class="ui-content">
            <h4>Consideraciones Generales - Lea por favor</h4>
            <ul>
                <li><strong>Verificar que el GPS esté activo</strong>. Las respuestas siempre se almacenarán, pero si se encuentra desactivado, no almacenará la georreferencia.</li>
                <li><strong>Comprobar Nro Usuario Asignado</strong>. Al finalizar c/u de las encuestas, puede modificar esta variable, y relacionar las respuestas a otro Usuario.</li>
                <li><strong>Desactivar Rotación pantalla</strong>. Al rotar la pantalla las respuestas en curso se blanquean y vuelve a lanzarse desde la pregunta y/o consigna Nro 1.</li>
            </ul>
        </div>
        <div data-role="footer">

        </div>
    </div>


    <div data-role="page" data-theme="a" id="pagina1">
        <div data-role="header" style="text-align: center">
            <h5>&COPY; SGE-V 1.1</h5>
            <label>Pregunta 1 de 5</label>
        </div>

        <div data-role="main">
            <div class="ui-content">
                <label for="1">1- ZONA</label>
                <select id="1" name="1" data-native-menu="false">
                    <option value="0">...</option>
                    <option value="12">CENTRO</option>
                    <option value="13">CENTRO/SUD</option>
                    <option value="14">SUD</option>
                    <option value="15">CASINO</option>
                    <option value="16">SUDOESTE</option>
                    <option value="17">ALBERDI</option>
                    <option value="18">ARROYITO</option>
                    <option value="19">PICHINCHA-ECHESORTU</option>
                    <option value="20">BARRIO PARQUE</option>
                    <option value="21">TRIANGULO Y ZONA</option>
                    <option value="22">FISHERTON Y ANTES</option>
                </select>


            </div>

        </div>

        <div data-role="footer" data-position="fixed">
            <div data-role="navbar">
                <ul>
                    <li><a href="#pagina0" data-iconpos="bottom" data-icon="gear">Configuracion</a></li>
                    <li><a href="#pagina0" data-iconpos="bottom" data-icon="arrow-l">Atras</a></li>
                    <li><a href="#pagina2" data-iconpos="bottom" data-icon="arrow-r">Adelante</a></li>
                    <li><a href="#pagina6" data-iconpos="bottom" data-icon="check">Finalizar</a></li>
                </ul>
            </div>
        </div>
    </div>


    <div data-role="page" data-theme="a" id="pagina2">
        <div data-role="header" style="text-align: center">
            <h5>&COPY; SGE-V 1.1</h5>
            <label>Pregunta 2 de 5</label>
        </div>

        <div data-role="main">
            <div class="ui-content">
                <label for="2">2- SEXO</label>
                <select id="2" name="2" data-native-menu="false">
                    <option value="0">...</option>
                    <option value="1">MASCULINO</option>
                    <option value="2">FEMENINO</option>
                </select>

            </div>

        </div>

        <div data-role="footer" data-position="fixed">
            <div data-role="navbar">
                <ul>
                    <li><a href="#pagina0" data-iconpos="bottom" data-icon="gear">Configuracion</a></li>
                    <li><a href="#pagina1" data-iconpos="bottom" data-icon="arrow-l">Atras</a></li>
                    <li><a href="#pagina3" data-iconpos="bottom" data-icon="arrow-r">Adelante</a></li>
                    <li><a href="#pagina6" data-iconpos="bottom" data-icon="check">Finalizar</a></li>
                </ul>
            </div>
        </div>
    </div>


    <div data-role="page" data-theme="a" id="pagina3">
        <div data-role="header" style="text-align: center">
            <h5>&COPY; SGE-V 1.1</h5>
            <label>Pregunta 3 de 5</label>
        </div>

        <div data-role="main">
            <div class="ui-content">
                <label for="3">3- EDAD</label>
                <select id="3" name="3" data-native-menu="false">
                    <option value="0">...</option>
                    <option value="16">16</option>
                    <option value="17">17</option>
                    <option value="18">18</option>
                    <option value="19">19</option>
                    <option value="20">20</option>
                    <option value="21">21</option>
                    <option value="22">22</option>
                    <option value="23">23</option>
                    <option value="24">24</option>
                    <option value="25">25</option>
                    <option value="26">26</option>
                    <option value="27">27</option>
                    <option value="28">28</option>
                    <option value="29">29</option>
                    <option value="30">30</option>
                    <option value="31">31</option>
                    <option value="32">32</option>
                    <option value="33">33</option>
                    <option value="34">34</option>
                    <option value="35">35</option>
                    <option value="36">36</option>
                    <option value="37">37</option>
                    <option value="38">38</option>
                    <option value="39">39</option>
                    <option value="40">40</option>
                    <option value="41">41</option>
                    <option value="42">42</option>
                    <option value="43">43</option>
                    <option value="44">44</option>
                    <option value="45">45</option>
                    <option value="46">46</option>
                    <option value="47">47</option>
                    <option value="48">48</option>
                    <option value="49">49</option>
                    <option value="50">50</option>
                    <option value="51">51</option>
                    <option value="52">52</option>
                    <option value="53">53</option>
                    <option value="54">54</option>
                    <option value="55">55</option>
                    <option value="56">56</option>
                    <option value="57">57</option>
                    <option value="58">58</option>
                    <option value="59">59</option>
                    <option value="60">60</option>
                    <option value="61">61</option>
                    <option value="62">62</option>
                    <option value="63">63</option>
                    <option value="64">64</option>
                    <option value="65">65</option>
                    <option value="66">66</option>
                    <option value="67">67</option>
                    <option value="68">68</option>
                    <option value="69">69</option>
                    <option value="70">70</option>
                    <option value="71">71</option>
                    <option value="72">72</option>
                    <option value="73">73</option>
                    <option value="74">74</option>
                    <option value="75">75</option>
                    <option value="76">76</option>
                    <option value="77">77</option>
                    <option value="78">78</option>
                    <option value="79">79</option>
                    <option value="80">80</option>
                </select>

            </div>

        </div>

        <div data-role="footer" data-position="fixed">
            <div data-role="navbar">
                <ul>
                    <li><a href="#pagina0" data-iconpos="bottom" data-icon="gear">Configuracion</a></li>
                    <li><a href="#pagina2" data-iconpos="bottom" data-icon="arrow-l">Atras</a></li>
                    <li><a href="#pagina4" data-iconpos="bottom" data-icon="arrow-r">Adelante</a></li>
                    <li><a href="#pagina6" data-iconpos="bottom" data-icon="check">Finalizar</a></li>
                </ul>
            </div>
        </div>
    </div>


    <div data-role="page" data-theme="a" id="pagina4">
        <div data-role="header" style="text-align: center">
            <h5>&COPY; SGE-V 1.1</h5>
            <label>Pregunta 4 de 5</label>
        </div>

        <div data-role="main">
            <div class="ui-content">
                <label for="4">4- OCUPACION PRINCIPAL</label>
                <select id="4" name="4" data-native-menu="false">
                    <option value="0">...</option>
                    <option value="1">SIN ESCOLARIDAD</option>
                    <option value="2">PRIMARIO INCOMPLETO</option>
                    <option value="3">PRIMARIO COMPLETO</option>
                    <option value="4">SECUNDARIO INCOMPLETO</option>
                    <option value="5">SECUNDARIO COMPLETO</option>
                    <option value="6">TERCIARIO INCOMPLETO</option>
                    <option value="7">TERCIARIO COMPLETO</option>
                    <option value="8">UNIVERSITARIO INCOMP</option>
                    <option value="9">UNIVERSITARIO COMPLETO O MAS</option>
                </select>

            </div>

        </div>

        <div data-role="footer" data-position="fixed">
            <div data-role="navbar">
                <ul>
                    <li><a href="#pagina0" data-iconpos="bottom" data-icon="gear">Configuracion</a></li>
                    <li><a href="#pagina3" data-iconpos="bottom" data-icon="arrow-l">Atras</a></li>
                    <li><a href="#pagina5" data-iconpos="bottom" data-icon="arrow-r">Adelante</a></li>
                    <li><a href="#pagina6" data-iconpos="bottom" data-icon="check">Finalizar</a></li>
                </ul>
            </div>
        </div>
    </div>


    <div data-role="page" data-theme="a" id="pagina5">
        <div data-role="header" style="text-align: center">
            <h5>&COPY; SGE-V 1.1</h5>
            <label>Pregunta 5 de 5</label>
        </div>

        <div data-role="main">
            <div class="ui-content">
                <label for="5">5- ¿CUALES SON LAS PRINCIPALES LINEAS QUE UTILIZA?</label>
                <input id="5" name="5" type="text" value="-" data-clear-btn="true"/>

            </div>

        </div>

        <div data-role="footer" data-position="fixed">
            <div data-role="navbar">
                <ul>
                    <li><a href="#pagina0" data-iconpos="bottom" data-icon="gear">Configuracion</a></li>
                    <li><a href="#pagina4" data-iconpos="bottom" data-icon="arrow-l">Atras</a></li>
                    <li><a href="#pagina6" data-iconpos="bottom" data-icon="arrow-r">Adelante</a></li>
                    <li><a href="#pagina6" data-iconpos="bottom" data-icon="check">Finalizar</a></li>
                </ul>
            </div>
        </div>
    </div>


    <div data-role="page" data-theme="a" id="pagina6">
        <div data-role="header">
            <h3>&COPY; SGE-V 1.1</h3>
        </div>

        <div data-role="main">
            <div class="ui-content">
                <h4 style="text-align:center">FIN DE LA ENCUESTA</h4>
                <div id="estado" data-role="popup"> </div>
            </div>
        </div>
        <div data-role="footer" data-position="fixed">
            <div data-role="navbar">
                <ul>
                    <li><a href="#pagina1" data-iconpos="bottom" data-icon="home">Inicio</a></li>
                    <li><a href="#pagina4" data-iconpos="bottom" data-icon="arrow-l">Atras</a></li>
                    <li>
                        <button type="reset" form="encuesta" data-exclude-selector=".exclude" data-iconpos="bottom" data-icon="check" onclick="no_vacio(5)" />Guardar</button>
                    </li>
                    <li><a href="#" onClick="salida()" data-iconpos="bottom" data-icon="power">Salir</a></li>
                </ul>
            </div>
        </div>
    </div>
</form>

<script type="text/javascript">

    function Guardar_Android(texto) {
       Android.guardar(texto);
       initiateReset();
    }

    function salida() {
        Android.salir();
    }

    function obtenerDatos(cant_preg) {
        var cadena = '';
        var id_encuesta = document.getElementById('id_encuesta').value;
        var nro_usuario = document.getElementById('usuario').value;

        for (i=1; i <= cant_preg ; i ++){
            var nro = document.getElementById(i);
            if(typeof nro !== 'undefined' && nro !== null) {

                var nro = document.getElementById(i).value ;

            }else{
                var sel_f 	= document.getElementById('F_' + i); // Buscar valores en filas
                var sel_c 	= document.getElementById('C_' + i); // Buscar valores en columnas

                texto = '';

                for(x=0; x < sel_f.children.length; x++){
                    var child_f = sel_f.children[x];
                    var child_c = sel_c.children[x];

                    if(child_f.value > 0){
                        var texto = texto + child_f.value + '_' + child_c.value + '.' ;
                    }
                }
                var texto = texto.substring(0, texto.length-1);
                var nro = texto;
            }
            cadena = cadena + nro + ';' ;
        }
        return id_encuesta + ';' + nro_usuario + ';' + cadena ;
    }

    function no_vacio(cant_preg){

        var error = 0;
        for (i=1; i <= cant_preg ; i ++){
            var respuesta = document.getElementById(i);
            if(typeof respuesta !== 'undefined' && respuesta !== null) {
                if(document.getElementById(i).value == 0){

                    var html = "<p> <a href='#pagina"+ i +"'>Respuesta " + i + " sin responder</a> </p>";

                    $("#estado").html(html);
                    $("#estado").popup("open");
                    error = 1;
                    break;
                }
            }else{
                var sel_f 	= document.getElementById('F_' + i); // Buscar valores en filas
                var sel_c 	= document.getElementById('C_' + i); // Buscar valores en columnas

                if(sel_f.children.length == 0 & sel_c.children.length == 0){

                    var html = "<p> <a href='#pagina"+ i +"'>Respuesta " + i + " sin responder</a> </p>";

                    $("#estado").html(html);
                    $("#estado").popup("open");
                    error = 1;
                    break;
                }
            }
        }
        //
        if(error === 0){
            var datos = obtenerDatos(cant_preg);
            Guardar_Android(datos);
        }
    }

</script>

<script>

var dataKey = 'data-exclude-selector';

function initiateReset(e) {
    e = e || window.event;

    var button = e.target,
        form = button.form,
        excludeSelector = button.getAttribute(dataKey);

    form.setAttribute(dataKey, excludeSelector);
}

function beforeReset(e) {
    e = e || window.event;

    var form = e.target,
        excludeSelector = form.getAttribute(dataKey),
        elements = form.querySelectorAll(excludeSelector),
        parents = [],
        siblings = [],
        len = elements.length,
        i, e, p, s;

    for (i = 0; i < len; i++) {
        el = elements[i];
        parents.push(p = el.parentNode);
        siblings.push(s = el.nextSibling);
        p.removeChild(el);
    }

    setTimeout(function() {
        for (var j = 0; j < len; j++){
            if (siblings[j]){
                parents[j].insertBefore(elements[j], siblings[j]);
            }else{
                parents[j].appendChild(elements[j]);
            }
        }
    });
}

</script>

</body>
</html>
